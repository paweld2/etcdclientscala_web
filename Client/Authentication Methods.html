<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Authentication Methods &mdash; EtcdClient 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="EtcdClient 1.0 documentation" href="../index.html" />
    <link rel="next" title="Member Methods" href="Member Methods.html" />
    <link rel="prev" title="Statistics Methods" href="Statistics.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">EtcdClient 1.0 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="Statistics.html" title="Statistics Methods"
             accesskey="P">previous</a> |
          <a href="Member Methods.html" title="Member Methods"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="authentication-methods">
<span id="id1"></span><h1>Authentication Methods<a class="headerlink" href="#authentication-methods" title="Permalink to this headline">¶</a></h1>
<p>The implementation of authentication methods follows the specification given in the <a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html">etcd authentication and security API</a>.
etcd permits the use of authentication only on authentication and key-value methods.</p>
<p>There are three types of authentication resources in etcd. Users, roles and permissions.</p>
<ol class="arabic simple">
<li>A user is an identity to be authenticated and under which one can get access to different resources in etcd.
A user has a list of permissions and a list of roles.</li>
<li>A role is basically a list of permissions that can be granted to a number of users.</li>
<li>A permission grants access to resources in etcd.
It can be either read access, write access, or both.</li>
</ol>
<p>With the help of authentication methods, a system administrator can enable or disable authentication.
It is also possible to create, update or delete users and roles with different levels of access to etcd.
Once authentication is enabled, users must get authorization in order to get or set data in etcd.</p>
<div class="section" id="getauthenticationstatus">
<span id="id2"></span><h2>getAuthenticationStatus<a class="headerlink" href="#getauthenticationstatus" title="Permalink to this headline">¶</a></h2>
<p>Checks whether authentication is enabled or disabled:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">getAuthenticationStatus</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetAuthenticationStatusResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdGetAuthenticationStatusResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdGetAuthenticationStatusResult</strong>.</p>
</div>
<div class="section" id="enableauthentication">
<span id="id3"></span><h2>enableAuthentication<a class="headerlink" href="#enableauthentication" title="Permalink to this headline">¶</a></h2>
<p>Enables authentication:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">enableAuthentication</span><span class="o">()</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdDefaultResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p>In order to enable authentication, the root user must be created first using <a class="reference internal" href="#addupdateuser"><span>addUpdateUser</span></a>.
After authentication only the root user or users with root rights (for example, with the root role) can access and modify permission resources.</p>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdConfirmationResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdConfirmationResult</strong>.</p>
</div>
<div class="section" id="disableauthentication">
<span id="id5"></span><h2>disableAuthentication<a class="headerlink" href="#disableauthentication" title="Permalink to this headline">¶</a></h2>
<p>Disables authentication:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">disableAuthentication</span><span class="o">()</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdDefaultResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdConfirmationResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdConfirmationResult</strong>.</p>
</div>
<div class="section" id="addupdateuser">
<span id="id7"></span><h2>addUpdateUser<a class="headerlink" href="#addupdateuser" title="Permalink to this headline">¶</a></h2>
<p>Creates an user or updates the details of an existing one:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">addUpdateUser</span><span class="o">(</span><span class="n">user</span><span class="k">:</span> <span class="kt">EtcdUserRequestForm</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdAddUpdateUserResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p>In order to add a new user, one must fill a <a class="reference internal" href="../Model/Model.html#etcduserrequestform"><span>EtcdUserRequestForm</span></a> and pass it as an argument to this method.</p>
<p>Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><strong>user</strong>: <a class="reference internal" href="../Model/Model.html#etcduserrequestform"><span>EtcdUserRequestForm</span></a> containing the details (login, password, granted and revoked permissions, and roles) to be updated for a given user.</li>
</ul>
</div></blockquote>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdAddUpdateUserResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdAddUpdateUserResult</strong>.</p>
</div>
<div class="section" id="deleteuser">
<span id="id9"></span><h2>deleteUser<a class="headerlink" href="#deleteuser" title="Permalink to this headline">¶</a></h2>
<p>Deletes an existing user:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">deleteUser</span><span class="o">(</span><span class="n">user</span><span class="k">:</span> <span class="kt">EtcdUserRequestForm</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdDefaultResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p>Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><strong>user</strong>: <a class="reference internal" href="../Model/Model.html#etcduserrequestform"><span>EtcdUserRequestForm</span></a> containing the details of a given user.</li>
</ul>
</div></blockquote>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdConfirmationResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdConfirmationResult</strong>.</p>
</div>
<div class="section" id="getusers">
<span id="id11"></span><h2>getUsers<a class="headerlink" href="#getusers" title="Permalink to this headline">¶</a></h2>
<p>Gets a list of users and their details:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">getUsers</span><span class="o">()</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetUsersResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdGetUsersResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdGetUsersResult</strong>.</p>
</div>
<div class="section" id="getuserdetails">
<span id="id13"></span><h2>getUserDetails<a class="headerlink" href="#getuserdetails" title="Permalink to this headline">¶</a></h2>
<p>Gets the details of a user:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">getUserDetails</span><span class="o">(</span><span class="n">user</span><span class="k">:</span> <span class="kt">EtcdUserRequestForm</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetUserDetailsResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p>In this case, it suffices to provide the user field in the <a class="reference internal" href="../Model/Model.html#etcduserrequestform"><span>EtcdUserRequestForm</span></a>.</p>
<p>Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><strong>user</strong>: <a class="reference internal" href="../Model/Model.html#etcduserrequestform"><span>EtcdUserRequestForm</span></a> containing the details of a given user.</li>
</ul>
</div></blockquote>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdGetUserDetailsResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdGetUserDetailsResult</strong>.</p>
</div>
<div class="section" id="addupdaterole">
<span id="id15"></span><h2>addUpdateRole<a class="headerlink" href="#addupdaterole" title="Permalink to this headline">¶</a></h2>
<p>Creates a role or updates an existing one:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">addUpdateRole</span><span class="o">(</span><span class="n">role</span><span class="k">:</span> <span class="kt">EtcdRole</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdCreateUpdateRoleResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p>Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><strong>role</strong>: <a class="reference internal" href="../Model/Model.html#etcdrole"><span>EtcdRole</span></a> with details of the role to be created or updated.</li>
</ul>
</div></blockquote>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdAddUpdateRoleResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdAddUpdateRoleResult</strong>.</p>
</div>
<div class="section" id="deleterole">
<span id="id17"></span><h2>deleteRole<a class="headerlink" href="#deleterole" title="Permalink to this headline">¶</a></h2>
<p>Deletes a role:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">deleteRole</span><span class="o">(</span><span class="n">role</span><span class="k">:</span> <span class="kt">EtcdRole</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdDefaultResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p>In this case, it suffices to provide the role field in the <a class="reference internal" href="../Model/Model.html#etcdrole"><span>EtcdRole</span></a>.</p>
<p>Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><strong>role</strong>: <a class="reference internal" href="../Model/Model.html#etcdrole"><span>EtcdRole</span></a> with details of the role to be created or updated.</li>
</ul>
</div></blockquote>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdConfirmationResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdConfirmationResult</strong>.</p>
</div>
<div class="section" id="getroles">
<span id="id19"></span><h2>getRoles<a class="headerlink" href="#getroles" title="Permalink to this headline">¶</a></h2>
<p>Gets a list of the existing roles and their details:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">getRoles</span><span class="o">()</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetRolesResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdGetRolesResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdGetRolesResult</strong>.</p>
</div>
<div class="section" id="getroledetails">
<span id="id21"></span><h2>getRoleDetails<a class="headerlink" href="#getroledetails" title="Permalink to this headline">¶</a></h2>
<p>Lists the details of a role:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="n">getRoleDetails</span><span class="o">(</span><span class="n">role</span><span class="k">:</span> <span class="kt">EtcdRole</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetRoleDetailsResult</span><span class="o">]</span>
</pre></div>
</div>
<p>Implemented according to etcd Auth and Security API: &#8220;<a class="reference external" href="https://coreos.com/etcd/docs/latest/v2/auth_api.html#api-endpoints">API endpoints</a> &#8221;.</p>
<p>In this case, it suffices to provide the role field in the <a class="reference internal" href="../Model/Model.html#etcdrole"><span>EtcdRole</span></a>.</p>
<p>Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><strong>role</strong>: <a class="reference internal" href="../Model/Model.html#etcdrole"><span>EtcdRole</span></a> with details of the role to be created or updated.</li>
</ul>
</div></blockquote>
<p><strong>Returns</strong> a Future wrapped around either <strong>EtcdGetRoleDetailsResponse</strong> or <strong>EtcdStandardError</strong> extending <strong>EtcdGetRoleDetailsResult</strong>.</p>
</div>
<div class="section" id="a-possible-work-flow">
<span id="a-possible-work-flow-authenticationdocs"></span><h2>A possible work flow<a class="headerlink" href="#a-possible-work-flow" title="Permalink to this headline">¶</a></h2>
<p>The following snippets of code are meant to be read linearly.
Each depends on the previous one.
They present subsequent operations using EtcdClient&#8217;s authentication methods.</p>
<p>We first check if authentication is enabled.
By default, it is disabled:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">statusQuery</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetAuthenticationStatusResult</span><span class="o">]</span> <span class="k">=</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">getAuthenticationStatus</span>

<span class="n">statusQuery</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdGetAuthenticationStatusResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be Some(false) if authentication is not enabled</span>
    <span class="c1">// Some(true) otherwise.</span>
    <span class="n">body</span><span class="o">.</span><span class="n">enabled</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Next, we would like to enable authentication.
In order to do so, we must first create the root user using <a class="reference internal" href="#addupdateuser"><span>addUpdateUser</span></a>.
If we try to enable authentication before this, we get an error:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">enableFail</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdConfirmationResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">status</span> <span class="k">&lt;-</span> <span class="n">statusQuery</span>
  <span class="n">enable</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">enableAuthentication</span><span class="o">()</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">enable</span>

<span class="n">enableFail</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">error</span> <span class="k">@</span> <span class="nc">EtcdStandardError</span><span class="o">(</span><span class="n">status</span><span class="o">,</span> <span class="n">clusterId</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// when there is no root user</span>
    <span class="c1">// should be &quot;auth: No root user available, please create one&quot;</span>
    <span class="n">message</span><span class="o">.</span><span class="n">message</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The following example shows how to add the root user.
First we fill an <a class="reference internal" href="../Model/Model.html#etcduserrequestform"><span>EtcdUserRequestForm</span></a>:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">rootUser</span><span class="k">:</span> <span class="kt">EtcdUserRequestForm</span> <span class="o">=</span> <span class="nc">EtcdUserRequestForm</span><span class="o">(</span><span class="s">&quot;root&quot;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">))</span>
</pre></div>
</div>
<p>Then we can add a new user:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">rootUserCreated</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdAddUpdateUserResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">enable</span> <span class="k">&lt;-</span> <span class="n">enableFail</span>
  <span class="n">added</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">addUpdateUser</span><span class="o">(</span><span class="n">rootUser</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">added</span>

<span class="n">rootUserCreated</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdAddUpdateUserResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be rootUser.user</span>
    <span class="n">body</span><span class="o">.</span><span class="n">user</span>
    <span class="c1">// should be List(&quot;root&quot;)</span>
    <span class="n">body</span><span class="o">.</span><span class="n">roles</span>
<span class="o">}</span>
</pre></div>
</div>
<p>We also add another user, in order to have a more involved example:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">newUser</span><span class="k">:</span> <span class="kt">EtcdUserRequestForm</span> <span class="o">=</span> <span class="nc">EtcdUserRequestForm</span><span class="o">(</span><span class="s">&quot;antonio&quot;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">))</span>

<span class="k">val</span> <span class="n">newUserCreated</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdAddUpdateUserResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">rootAdded</span> <span class="k">&lt;-</span> <span class="n">rootUserCreated</span>
  <span class="n">added</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">addUpdateUser</span><span class="o">(</span><span class="n">newUser</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">added</span>

<span class="n">newUserCreated</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdAddUpdateUserResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be newUser.user</span>
    <span class="n">body</span><span class="o">.</span><span class="n">user</span>
    <span class="c1">// should be List()</span>
    <span class="n">body</span><span class="o">.</span><span class="n">roles</span>
<span class="o">}</span>
</pre></div>
</div>
<p>And we create a new role, with permissions to read and write in the user space, i.e. it can add, delete and update users.
First we specify the name and permissions of the new role through the <a class="reference internal" href="../Model/Model.html#etcdrole"><span>EtcdRole</span></a> case class, and then we perform an <a class="reference internal" href="#addupdaterole"><span>addUpdateRole</span></a> operation:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">newRole</span><span class="k">:</span> <span class="kt">EtcdRole</span> <span class="o">=</span>
  <span class="nc">EtcdRole</span><span class="o">(</span><span class="s">&quot;usersAdmin&quot;</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">EtcdPermission</span><span class="o">(</span><span class="nc">EtcdKV</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="s">&quot;/users/*&quot;</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;/users/*&quot;</span><span class="o">)))))</span>

<span class="k">val</span> <span class="n">newRoleCreated</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdAddUpdateRoleResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">newUserAdded</span> <span class="k">&lt;-</span> <span class="n">newUserCreated</span>
  <span class="n">added</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">addUpdateRole</span><span class="o">(</span><span class="n">newRole</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">added</span>

<span class="n">newRoleCreated</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdAddUpdateRoleResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">//  should be newRole.role</span>
    <span class="n">body</span><span class="o">.</span><span class="n">role</span>
    <span class="c1">// should be List(&quot;/users/*&quot;)</span>
    <span class="n">body</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">kv</span><span class="o">.</span><span class="n">read</span>
    <span class="c1">// should be List(&quot;/users/*&quot;)</span>
    <span class="n">body</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">kv</span><span class="o">.</span><span class="n">write</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Once the root user has been created, we can enable authentication:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">authEnabled</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdConfirmationResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">added</span> <span class="k">&lt;-</span> <span class="n">newRoleCreated</span>
  <span class="n">enabled</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">enableAuthentication</span><span class="o">()</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">enabled</span>

<span class="n">authEnabled</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="c1">// a response without a body which only contains an id found in the headers</span>
  <span class="k">case</span> <span class="nc">EtcdConfirmationResponse</span><span class="o">(</span><span class="n">clusterID</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be a string with an id of the member of the cluster</span>
    <span class="n">clusterID</span><span class="o">.</span><span class="n">id</span>
<span class="o">}</span>
</pre></div>
</div>
<p>After authentication is enabled, only the root user or users with root rights can access and modify permission resources.
For instance, let us try to get the details of a user without authentication:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">getUserFailed</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetUserDetailsResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">enabled</span> <span class="k">&lt;-</span> <span class="n">authEnabled</span>
  <span class="c1">// without authorization</span>
  <span class="c1">// rootUser was defined in an example above</span>
  <span class="n">details</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">getUserDetails</span><span class="o">(</span><span class="n">rootUser</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">details</span>

<span class="n">getUserFailed</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">error</span> <span class="k">@</span> <span class="nc">EtcdStandardError</span><span class="o">(</span><span class="n">status</span><span class="o">,</span> <span class="n">clusterId</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be &quot;Insufficient credentials&quot;</span>
    <span class="n">message</span><span class="o">.</span><span class="n">message</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now, we provide some data in order to get authorization:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">rootAccess</span> <span class="k">=</span> <span class="nc">EtcdUserAuthenticationData</span><span class="o">(</span><span class="s">&quot;root&quot;</span><span class="o">,</span> <span class="s">&quot;password&quot;</span><span class="o">)</span>

<span class="k">val</span> <span class="n">etcdClientRoot</span><span class="k">:</span> <span class="kt">EtcdClient</span> <span class="o">=</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">withAuthorization</span><span class="o">(</span><span class="n">rootAccess</span><span class="o">)</span>

<span class="k">val</span> <span class="n">getUserSuccess</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetUserDetailsResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">failed</span> <span class="k">&lt;-</span> <span class="n">getUserFailed</span>
  <span class="c1">//with authorization</span>
  <span class="n">success</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">getUserDetails</span><span class="o">(</span><span class="n">rootUser</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">success</span>

<span class="n">getUserSuccess</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdGetUserDetailsResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be rootUser.user</span>
    <span class="n">body</span><span class="o">.</span><span class="n">user</span>
    <span class="c1">// should be</span>
    <span class="c1">// List(EtcdRole(&quot;root&quot;, Some(EtcdPermission(EtcdKV(List(&quot;/*&quot;), List(&quot;/*&quot;)))), None, None))</span>
    <span class="n">body</span><span class="o">.</span><span class="n">roles</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The same applies to the getRoleDetails method:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">getRole</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetRoleDetailsResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">user</span> <span class="k">&lt;-</span> <span class="n">getUserSuccess</span>
  <span class="c1">// newRole was defined in an example above</span>
  <span class="c1">//with authorization</span>
  <span class="n">role</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">getRoleDetails</span><span class="o">(</span><span class="n">newRole</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">role</span>

<span class="n">getRole</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdGetRoleDetailsResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be newRole.role</span>
    <span class="n">body</span><span class="o">.</span><span class="n">role</span>
    <span class="c1">// should be &quot;/users/*&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">kv</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">head</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now let us list all users and all roles:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">listOfUsers</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetUsersResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">role</span> <span class="k">&lt;-</span> <span class="n">getRole</span>
  <span class="n">list</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">getUsers</span><span class="o">()</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">list</span>

<span class="n">listOfUsers</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdGetUsersResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be &quot;antonio&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">user</span>
    <span class="c1">// should be &quot;root&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">user</span>
    <span class="c1">// should be &quot;root&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">role</span>
    <span class="c1">// should be &quot;/*&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">kv</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">head</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">listOfRoles</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdGetRolesResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">users</span> <span class="k">&lt;-</span> <span class="n">listOfUsers</span>
  <span class="c1">//with authorization</span>
  <span class="n">list</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">getRoles</span><span class="o">()</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">list</span>

<span class="n">listOfRoles</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdGetRolesResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be &quot;guest&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">role</span>
    <span class="c1">//  should be &quot;root&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">role</span>
    <span class="c1">// should be &quot;/*&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">kv</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">head</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Notice that there is a role named &#8220;guest&#8221;.
The guest role defines what users can do without authentication.</p>
<p>Let us next update a user with a new role.
Again, first we fill a <a class="reference internal" href="../Model/Model.html#etcduserrequestform"><span>EtcdUserRequestForm</span></a>, and then we perform the operation:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">newUserUpdate</span><span class="k">:</span> <span class="kt">EtcdUserRequestForm</span> <span class="o">=</span>
  <span class="nc">EtcdUserRequestForm</span><span class="o">(</span><span class="s">&quot;antonio&quot;</span><span class="o">,</span> <span class="nc">None</span><span class="o">,</span> <span class="nc">List</span><span class="o">(),</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;usersAdmin&quot;</span><span class="o">))</span>

<span class="k">val</span> <span class="n">newUserUpdated</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdAddUpdateUserResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">list</span> <span class="k">&lt;-</span> <span class="n">listOfRoles</span>
  <span class="n">updated</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">addUpdateUser</span><span class="o">(</span><span class="n">newUserUpdate</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">updated</span>

<span class="n">newUserUpdated</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdAddUpdateUserResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be newUser.user</span>
    <span class="n">body</span><span class="o">.</span><span class="n">user</span>
    <span class="c1">// should be &quot;usersAdmin&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">head</span>
<span class="o">}</span>
</pre></div>
</div>
<p>We would also like to update a role.
In the following example the guest role is updated;
read and write permissions on the key space are revoked:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="c1">// role with a permissions to read and write in the key space</span>
<span class="c1">// placed in the revoke field, i.e. a request to revoke read</span>
<span class="c1">// and write permissions to the guest role</span>
<span class="k">val</span> <span class="n">guestRole</span><span class="k">:</span> <span class="kt">EtcdRole</span> <span class="o">=</span>
  <span class="nc">EtcdRole</span><span class="o">(</span><span class="s">&quot;guest&quot;</span><span class="o">,</span> <span class="nc">None</span><span class="o">,</span> <span class="nc">None</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="nc">EtcdPermission</span><span class="o">(</span><span class="nc">EtcdKV</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="s">&quot;/*&quot;</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="s">&quot;/*&quot;</span><span class="o">)))))</span>

<span class="k">val</span> <span class="n">guestRoleUpdated</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdAddUpdateRoleResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">newUserUpdated</span> <span class="k">&lt;-</span> <span class="n">newUserUpdated</span>
  <span class="n">updated</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">addUpdateRole</span><span class="o">(</span><span class="n">guestRole</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">updated</span>

<span class="n">guestRoleUpdated</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdAddUpdateRoleResponse</span><span class="o">(</span><span class="n">clusterId</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be guestRole.role</span>
    <span class="n">body</span><span class="o">.</span><span class="n">role</span>
    <span class="c1">// should be List()</span>
    <span class="n">body</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">kv</span><span class="o">.</span><span class="n">read</span>
    <span class="c1">// should be List()</span>
    <span class="n">body</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">kv</span><span class="o">.</span><span class="n">write</span>
<span class="o">}</span>
</pre></div>
</div>
<p>After such operation, it is no longer possible to make key-value operations without authentication:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">newKey</span> <span class="k">=</span> <span class="nc">EtcdModel</span><span class="o">.</span><span class="n">key</span><span class="o">(</span><span class="s">&quot;/foo&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">newValue</span> <span class="k">=</span> <span class="nc">EtcdModel</span><span class="o">.</span><span class="n">value</span><span class="o">(</span><span class="s">&quot;bar&quot;</span><span class="o">)</span>

<span class="k">val</span> <span class="n">setFailure</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdSetKeyResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">updated</span> <span class="k">&lt;-</span> <span class="n">guestRoleUpdated</span>
  <span class="c1">// without the proper credentials</span>
  <span class="n">failure</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">setKey</span><span class="o">(</span><span class="n">newKey</span><span class="o">,</span> <span class="n">newValue</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">failure</span>

<span class="n">setFailure</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">error</span> <span class="k">@</span> <span class="nc">EtcdRequestError</span><span class="o">(</span><span class="n">status</span><span class="o">,</span> <span class="n">headers</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="n">body</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">EtcdError</span><span class="o">(</span><span class="n">cause</span><span class="o">,</span> <span class="n">errorCode</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="c1">// should be 110</span>
        <span class="n">errorCode</span>
        <span class="c1">// should be &quot;The request requires user authentication&quot;</span>
        <span class="n">message</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">setSuccess</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdSetKeyResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">failure</span> <span class="k">&lt;-</span> <span class="n">setFailure</span>
  <span class="c1">//with root access</span>
  <span class="n">success</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">setKey</span><span class="o">(</span><span class="n">newKey</span><span class="o">,</span> <span class="n">newValue</span><span class="o">,</span> <span class="nc">None</span><span class="o">,</span> <span class="nc">None</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">success</span>

<span class="n">setSuccess</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdSetKeyResponse</span><span class="o">(</span><span class="n">headers</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be &quot;set&quot;</span>
    <span class="n">body</span><span class="o">.</span><span class="n">action</span>
    <span class="c1">// should be newValue</span>
    <span class="n">body</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">value</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now, suppose we no longer have a use for a user.
There is a method to delete users:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">newUserDeleted</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdConfirmationResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">success</span> <span class="k">&lt;-</span> <span class="n">setSuccess</span>
  <span class="c1">// with root access</span>
  <span class="n">deleted</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">deleteUser</span><span class="o">(</span><span class="n">newUser</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">deleted</span>

<span class="n">newUserDeleted</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdConfirmationResponse</span><span class="o">(</span><span class="n">clusterID</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="n">clusterID</span><span class="o">.</span><span class="n">id</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The same applies to roles:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">newRoleDeleted</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdConfirmationResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">userDeleted</span> <span class="k">&lt;-</span> <span class="n">newUserDeleted</span>
  <span class="c1">// with root access</span>
  <span class="n">deleted</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">deleteRole</span><span class="o">(</span><span class="n">newRole</span><span class="o">)</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">deleted</span>

<span class="n">newRoleDeleted</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdConfirmationResponse</span><span class="o">(</span><span class="n">clusterID</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be a string</span>
    <span class="n">clusterID</span><span class="o">.</span><span class="n">id</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Finally, let us suppose we choose to disable authentication:</p>
<div class="highlight-scala"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">disableAuthFailure</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdConfirmationResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">deleted</span> <span class="k">&lt;-</span> <span class="n">newRoleDeleted</span>
  <span class="c1">// without the proper credentials</span>
  <span class="n">failure</span> <span class="k">&lt;-</span> <span class="n">etcdcli</span><span class="o">.</span><span class="n">disableAuthentication</span><span class="o">()</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">failure</span>

<span class="n">disableAuthFailure</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">error</span> <span class="k">@</span> <span class="nc">EtcdStandardError</span><span class="o">(</span><span class="n">status</span><span class="o">,</span> <span class="n">clusterId</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="c1">// should be &quot;Insufficient credentials&quot;</span>
    <span class="n">message</span><span class="o">.</span><span class="n">message</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">disableAuthSuccess</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">EtcdConfirmationResult</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">failure</span> <span class="k">&lt;-</span> <span class="n">disableAuthFailure</span>
  <span class="c1">//with root access</span>
  <span class="n">success</span> <span class="k">&lt;-</span> <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">disableAuthentication</span><span class="o">()</span>
<span class="o">}</span> <span class="k">yield</span> <span class="n">success</span>

<span class="n">disableAuthSuccess</span> <span class="n">onSuccess</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">EtcdConfirmationResponse</span><span class="o">(</span><span class="n">clusterID</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="n">clusterID</span><span class="o">.</span><span class="n">id</span>
    <span class="n">etcdClientRoot</span><span class="o">.</span><span class="n">close</span><span class="o">()</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Quickstart/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Model/Model.html">Package Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="EtcdClient.html">EtcdClient</a></li>
<li class="toctree-l1"><a class="reference internal" href="Key-Value Methods.html">Key-Value Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Statistics.html">Statistics Methods</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Authentication Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getauthenticationstatus">getAuthenticationStatus</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enableauthentication">enableAuthentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disableauthentication">disableAuthentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#addupdateuser">addUpdateUser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deleteuser">deleteUser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getusers">getUsers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getuserdetails">getUserDetails</a></li>
<li class="toctree-l2"><a class="reference internal" href="#addupdaterole">addUpdateRole</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deleterole">deleteRole</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getroles">getRoles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getroledetails">getRoleDetails</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-possible-work-flow">A possible work flow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Member Methods.html">Member Methods</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="Statistics.html" title="Statistics Methods"
              >previous</a> |
            <a href="Member Methods.html" title="Member Methods"
              >next</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/Client/Authentication Methods.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Antonio Maciej Matamoros Ochman, Paweł Cesar Sanjuan Sklarz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>